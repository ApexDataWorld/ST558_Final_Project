---
title: "EDA"
format: html
editor: visual
---

## Introduction

The Diabetes Health Indicators dataset contains responses from adults in the 2015 BRFSS survey. The outcome of interest is `Diabetes_binary`, which indicates whether the respondent has diabetes (1) or not (0). The dataset also includes clinical risk factors (ex., blood pressure, cholesterol, BMI), lifestyle behaviors (smoking, physical activity, diet), access to care indicators, and demographic variables.

The goals of this EDA are to:

-   Understand how common diabetes is in this sample.

-   Explore how diabetes status varies across key predictors like BMI, blood pressure, physical activity, and self reported health.

-   Prepare the data (types, factor levels, basic checks) for modeling in the companion Modeling document.

```{r}
library(tidyverse)
library(tidymodels)

```

Load the data

```{r}
health_data <- read_csv("data/diabetes_binary_health_indicators_BRFSS2015.csv")
head(health_data)
```

```{r}

```

The dataset has 253,680 adults and 22 variables. Most predictors are coded as 0/1 and include things like blood pressure, cholesterol, BMI, smoking, and activity, along with demographics. The outcome `Diabetes_binary` tells us whether each person has diabetes or not.

```{r}
health_data |>
  is.na() |>
  colSums()
```

There are essentially no missing values in the dataset. This means we don’t need to do any imputation and can use the full data for our analysis and modeling.

```{r}
attributes(health_data)$spec
```

All variables are read in as numeric at first. The 0/1 variables represent yes/no answers and will later be turned into factors so the output is easier to read and interpret.

```{r}
summary(health_data)
```

About 14% of people in this sample have diabetes (mean of `Diabetes_binary` ≈ 0.139). BMI has a median around 27 and a mean around 28.4, which suggests that, on average, people in this dataset are in the overweight range. Many health behavior variables (like `PhysActivity`, `AnyHealthcare`) have medians at 1, meaning “Yes” is common.

```{r}
health_data <- health_data |>
  mutate(
    # Make the response a labeled factor
    Diabetes_binary = factor(Diabetes_binary,
                             levels = c(0, 1),
                             labels = c("NoDiabetes", "Diabetes")),
    HighBP = factor(HighBP, levels = c(0,1), labels = c("No", "Yes")),
    HighChol = factor(HighChol, levels = c(0,1), labels = c("No", "Yes")),
    CholCheck = factor(CholCheck, levels = c(0,1), labels = c("No", "Yes")),
    Smoker = factor(Smoker, levels = c(0,1), labels = c("No", "Yes")),
    Stroke = factor(Stroke, levels = c(0,1), labels = c("No", "Yes")),
    HeartDiseaseorAttack = factor(HeartDiseaseorAttack, levels = c(0,1),
                                  labels = c("No","Yes")),
    PhysActivity = factor(PhysActivity, levels = c(0,1), labels = c("No", "Yes")),
    Fruits = factor(Fruits, levels = c(0,1), labels = c("No", "Yes")),
    Veggies = factor(Veggies, levels = c(0,1), labels = c("No", "Yes")),
    HvyAlcoholConsump = factor(HvyAlcoholConsump, levels = c(0, 1),
                               labels = c("No", "Yes")),
    AnyHealthcare = factor(AnyHealthcare, levels = c(0,1), labels = c("No", "Yes")),
    NoDocbcCost = factor(NoDocbcCost, levels = c(0,1), labels = c("No", "Yes")),
    GenHlth = factor(GenHlth, levels = c(1:5),
                     labels = c("Excellent", "Very Good", "Good", "Fair", "Poor")),
    DiffWalk = factor(DiffWalk, levels = c(0,1), labels = c("No", "Yes")),
    Sex = factor(Sex, levels = c(0,1), labels = c("Female", "Male")),
    Age = factor(Age, levels = c(1:13),
                 labels = c("18-24", "25-29", "30-34", "35-39", "40-44",
                            "45-49", "50-54", "55-59", "60-64",
                            "65-69", "70-74", "75-79", "80+")),
    Education = factor(Education, levels = c(1:6),
                       labels = c("KG or No School", "Elementary", "Middle school",
                                  "High school", "College","Professional Degree")),
    Income = factor(Income, levels = c(1:8),
                    labels = c("<10K", "$10k-$15k", "$15k-$20k", "$20k-$25k",
                               "$25k-$35k", "$35k-$50k", "$50k-$75k", "$75k+"))
  )

health_data
```

All the key 0/1 variables have been relabeled with meaningful factor levels (for example, “NoDiabetes” / “Diabetes”, “No” / “Yes”, and age groups like “18–24”, “25–29”, etc.). This makes the plots and tables much easier to understand and is important for later modeling.

Check factor levels:

```{r}
# Check unique values for categorical variables

factor_col <- health_data |>
  select(where(is.factor))

lapply(factor_col, levels)
```

The factor levels look correct and are in a logical order. For example, general health goes from “Excellent” to “Poor”, and age moves from the youngest group (18–24) to the oldest (80+). This ordering will help when we interpret trends across categories.

Frequency tables for factors:

```{r}
# freq_table <- sapply(health_data, function(x) if(is.factor(x)) table(x) else NULL)
# freq_table 

factor_cont_table <- lapply(factor_col, table)
factor_cont_table
```

Most people in the sample do **not** have diabetes (around 218k with no diabetes vs about 35k with diabetes). Many respondents have high blood pressure or high cholesterol, and most have had a cholesterol check. A majority report having health insurance (`AnyHealthcare = Yes`), and many rate their general health as “Good” or “Very Good.” There are also more females than males in the dataset.

Unique outcome levels:

```{r}
unique(health_data$Diabetes_binary)
```

The outcome variable has two clean levels: “NoDiabetes” and “Diabetes.” This confirms we have a straightforward binary classification problem.

Overall diabetes prevalence

```{r}
ggplot(health_data, aes(x = Diabetes_binary)) +
  geom_bar() +
  labs(
    title = "Overall Diabetes Status",
    x = "Diabetes Status",
    y = "Count"
  )

```

The bar plot shows a strong class imbalance: most individuals do **not** have diabetes, and only a smaller portion do. This is important to remember because models might default to predicting the majority class if we’re not careful.

### Diabetes and sex

Proportions by sex:

```{r}
ggplot(health_data, aes(x = Sex, fill = Diabetes_binary)) +
  geom_bar(position = "fill") +
    labs(
      title = "Proportion with Diabetes by Sex",
      x = "Sex",
      y = "Proportion"
    ) +
  scale_y_continuous(labels = scales::percent)


```

The proportion of people with diabetes is fairly similar for males and females. There is no dramatic difference in diabetes rates between the two sexes when we look at proportions rather than raw counts.

Counts by sex:

```{r}
ggplot(health_data, aes(x = Sex, fill = Diabetes_binary)) +
  geom_bar(position = "dodge") +
    labs(
      title = "Diabetes Status by Sex",
      x = "Sex",
      y = "Count"
    )

```

There are more female than male respondents overall, which is why the count of women with diabetes is slightly higher than the count of men with diabetes. However, this difference in counts mostly reflects the different sample sizes rather than a huge difference in risk.

Contingency table:

```{r}
cont_table <- table(health_data$Diabetes_binary, health_data$Sex)

cont_table
```

```{r}
diab_count <- health_data |>
  group_by(Diabetes_binary) |>
  summarize(count = n())

diab_count
```

Bar plot with labels by diabetes status:

```{r}
ggplot(health_data, aes(x = Diabetes_binary, fill = Sex)) +
  geom_bar(position = "dodge") +
    geom_text(
      stat = "count",
      aes(label = ..count..),
      position = position_dodge(width = 0.9),
      vjust = -0.5
    ) +
    labs(
      title = "Diabetes Status by Gender",
      x = "Diabetes Status",
      y = "Count"
    ) +
  scale_fill_manual(values = c("Female" = "pink", "Male" = "blue")) +
  theme_minimal()


```

The plot confirms the overall numbers: roughly 218k people without diabetes and about 35k with diabetes. Both males and females contribute to the diabetes group, but non-diabetic cases heavily dominate the sample.

BMI distribution

```{r}
summary(health_data$BMI)
```

BMI ranges from 12 to 98, with most people between 24 and 31. The median BMI of 27 suggests that a large share of the sample is overweight or obese, which is consistent with known risk factors for diabetes.

```{r}
ggplot(health_data, aes(x = BMI)) +
  geom_histogram(binwidth = 2) +
    labs(
      title = "BMI Distribution",
      x = "BMI",
      y = "Frequency"
    )

```

The BMI distribution is right-skewed. Most participants cluster in the mid 20s to low 30s range, but there are a few very high BMI values, indicating some extreme obesity cases.

```{r}
ggplot(health_data, aes(x = "", y = BMI)) +
  geom_boxplot(fill = "orange") +
    labs(
      title = "BMI Distribution",
      x = "",
      y = "BMI"
    )


```

The boxplot shows many BMI values above the upper whisker, confirming there are several high-BMI outliers. These individuals might have especially high risk for diabetes and related conditions.

General health vs diabetes

```{r}
ggplot(health_data, aes(x = GenHlth, fill = Diabetes_binary)) +
  geom_bar(position = "dodge") +
    labs(
      title = "General Health vs. Diabetes Status",
        x = "General Health",
        y = "Count"
    ) +
    scale_fill_manual(
      values = c("NoDiabetes" = "lightgreen", "Diabetes" = "red"),
        name = "Diabetes Status"
    ) +
  theme_minimal()

```

People who report worse general health (“Fair” or “Poor”) are more likely to have diabetes. In contrast, those who report “Excellent” or “Very Good” health are much more likely to be in the non-diabetes group. This matches our expectation that diabetes is linked with poorer overall health.

Count of diabetes cases by sex

```{r}
# Summarize the counts for Diabetes_binary by Sex
diab_count <- health_data %>%
  filter(Diabetes_binary == "Diabetes") %>%
    group_by(Sex) %>%
      summarize(count = n(), .groups = "drop")

diab_count


```

```{r}
diab_count <- health_data %>%
  filter(Diabetes_binary == "Diabetes") %>%
    group_by(Sex) %>%
      summarize(count = n(), .groups = "drop")

diab_count

```

Among those with diabetes, the counts are 18,411 women and 16,935 men. The difference is not huge and mostly reflects that there are more women than men in the sample.

```{r}
ggplot(diab_count, aes(x = Sex, y = count, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
    labs(
      title = "Count of Diabetes Cases by Sex",
      x = "Sex",
      y = "Count"
    ) +
  theme_minimal()

```

Correlation among numeric variables

```{r}
# do some correlation on the numerical data 
health_data |>
  select(where(is.numeric)) |>
  cor() |>
  round(3)

```

BMI has only weak correlations with both mental health days and physical health days (correlations around 0.08–0.12). Mental and physical health days are more moderately correlated with each other (around 0.35). Overall, the numeric predictors we checked are not strongly correlated, which reduces concern about multi-collinearity for modeling.

Link to Modeling Page

[Click here for the Modeling Page](Modeling.html)

```{r}

```
